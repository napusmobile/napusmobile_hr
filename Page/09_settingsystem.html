<div class="row g-3 mt-2">
  <div class="col-md-6">
      <div class="card border-0 shadow-sm mb-3">
        <div class="card-header bg-white">
          <div class="row">
            <div class="col-12 col-md-4 mb-2 mb-md-0">üìÇ Folder</div>
            <div class="col-12 col-md-8 d-flex flex-wrap justify-content-md-end">
              
            </div>
          </div>
        </div>
        <div class="card-body rounded-4">
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üìÇ Folder</label>
                <input type="text" class="form-control" id="setData1">              
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üìÇ Folder</label>
                <input type="text" class="form-control" id="setData2">              
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üìÇ Folder</label>
                <input type="text" class="form-control" id="setData3">              
              </div>
            </div>
          </div>
          <button type="button" class="btn mt-2 set-button" onclick="addSetting()">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

      <div class="card border-0 shadow-sm mb-3">
        <div class="card-header bg-white">
          <div class="row">
            <div class="col-12 col-md-4 mb-2 mb-md-0">üíª ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å</div>
            <div class="col-12 col-md-8 d-flex flex-wrap justify-content-md-end">
              
            </div>
          </div>
        </div>
        <div class="card-body rounded-4">
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üíª ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å</label>
                <input type="text" class="form-control" id="setData4">            
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üíª ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</label>
                <input type="text" class="form-control" id="setData5">            
              </div>
            </div>
          </div>
          <button type="button" class="btn mt-2 set-button" onclick="addSetting()">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

      <div class="card border-0 shadow-sm mb-3">
        <div class="card-header bg-white">
          <div class="row">
            <div class="col-12 col-md-4 mb-2 mb-md-0">üõéÔ∏è Notify</div>
            <div class="col-12 col-md-8 d-flex flex-wrap justify-content-md-end">
              
            </div>
          </div>
        </div>
        <div class="card-body rounded-4">
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üõéÔ∏è LineClientId</label>
                <input type="text" class="form-control" id="setData6">             
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üõéÔ∏è LineClientSecret</label>
                <input type="text" class="form-control" id="setData7">             
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üõéÔ∏è RedirectUri</label>
                <input type="text" class="form-control" id="setData8">              
              </div>
            </div>
          </div>
          <button type="button" class="btn mt-2 set-button" onclick="addSetting()">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

      <div class="card border-0 shadow-sm mb-3">
        <div class="card-header bg-white">
          <div class="row">
            <div class="col-12 col-md-4 mb-2 mb-md-0">üè¢ System</div>
            <div class="col-12 col-md-8 d-flex flex-wrap justify-content-md-end">
              
            </div>
          </div>
        </div>
        <div class="card-body rounded-4">
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üèûÔ∏è Logo</label>
                <input type="text" class="form-control" id="setData9">            
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üìù System</label>
                <input type="text" class="form-control" id="setData10">            
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-6">
              <div class="mb-1">
                <label for="test1" class="form-label">üìù System</label>
                <input type="text" class="form-control" id="setData11">              
              </div>
            </div>
          </div>
          <button type="button" class="btn mt-2 set-button" onclick="addSetting()">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card border-0 shadow-sm mb-3">
      <div class="card-header bg-white">
        <div class="row">
          <div class="col-12 col-md-4 mb-2 mb-md-0">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</div>
          <div class="col-12 col-md-8 d-flex flex-wrap justify-content-md-end">
          </div>
        </div>
      </div>
      <div class="card-body rounded-4">
        <div class="table-responsive">
          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" class="text-center">#</th>
                <th scope="col" class="text-center">‡πÄ‡∏°‡∏ô‡∏π</th>
                <th scope="col" class="text-center">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                <th scope="col" class="text-center" style="color: var(--box1)">SuperAdmin</th>
                <th scope="col" class="text-center" style="color: var(--box2)">Admin</th>
                <th scope="col" class="text-center" style="color: var(--box3)">SuperUser</th>
                <th scope="col" class="text-center" style="color: var(--box4)">User</th>
              </tr>
            </thead>
            <tbody id="tableMenuCars"></tbody>       
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
let todoList = [];
let currentSheet = 'Department';

const loadTodos = (sheetName) => {
  if (event) {
    event.preventDefault();
  }
  currentSheet = sheetName;
  $.LoadingOverlay("show", {image: "", fontawesome: "fa fa-spinner fa-spin"});
  google.script.run.withSuccessHandler(function(todos) {
    todoList = todos;
    renderTodoList();
    $.LoadingOverlay("hide");
    document.getElementById('ModalDataSetting').querySelector('#dataSettingTitle').textContent = sheetName;
    $('#ModalDataSetting').modal('show');
  }).getTodos(sheetName);
}

const addTodoSet = () => {
const todoInput = document.getElementById('todoInput');
const todoText = todoInput.value.trim();
  if (todoText) {
    todoList.push(todoText);
    renderTodoList();
    todoInput.value = '';
  }
}

const removeTodo = (index) => {
  todoList.splice(index, 1);
  renderTodoList();
}

const editTodo = (index) => {
const todoTextElement = document.getElementById(`todo-text-${index}`);
      todoTextElement.removeAttribute('readonly');
      todoTextElement.focus();
}

const updateTodo = (index) => {
const todoTextElement = document.getElementById(`todo-text-${index}`);
      todoList[index] = todoTextElement.value.trim();
      todoTextElement.setAttribute('readonly', 'readonly');
      renderTodoList();
}

const renderTodoList = () => {
const todoListElement = document.getElementById('todoList');
      todoListElement.innerHTML = `
        <li class="list-group-item header-item" style="color: var(--bs-white); font-size: 18px;">
          <div class="d-flex justify-content-between">
            <span>üõ†Ô∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
            <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</span>
          </div>
        </li>`;
      todoList.forEach((todo, index) => {
const todoItem = document.createElement('li');
      todoItem.className = 'list-group-item todo-item';
      todoItem.innerHTML = `
          <input type="text" id="todo-text-${index}" value="${todo}" class="form-control me-2" readonly
                 onblur="updateTodo(${index})" onkeypress="if(event.key === 'Enter') updateTodo(${index})">
          <button class="btn edit-button btn-sm me-2" onclick="editTodo(${index})"><i class="fa fa-edit"></i></button>
          <button class="btn del-button btn-sm" onclick="removeTodo(${index})"><i class="fa fa-trash"></i></button>`;
    todoListElement.appendChild(todoItem);
  });
}

const renderMenuCars = (res) => {
  const table = document.getElementById('tableMenuCars');
  table.innerHTML = '';

  if (res.length === 0) {
    const row = table.insertRow();
    row.innerHTML = `<td colspan='9' class='fw-bold text-danger text-center p-4'><i class='fa-solid fa-circle-info text-danger'></i> ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•! üòì</td>`;
    return;
  }

  res.forEach((rowIndex, index) => {
    var row = table.insertRow();
    row.innerHTML = `
      <td class="text-center"><span style="font-size: 14px;">${index + 1}</span></td>
      <td><span style="font-size: 14px;">üíª ${rowIndex[0]}</span></td>
      <td><span style="font-size: 14px;">üîë ${rowIndex[1]}</span></td>
      <td class="text-center">
        <label class="customSet-checkbox">
            <input type="checkbox" ${rowIndex[2].toUpperCase() === "TRUE" ? "checked" : ""} onchange="updateMenu(${index}, 'SuperAdmin', this.checked)">
            <span class="checkmark"><i class="fa-solid fa-check"></i><i class="fa-solid fa-xmark"></i></span>
        </label>
      </td>
      <td class="text-center">
        <label class="customSet-checkbox">
            <input type="checkbox" ${rowIndex[3].toUpperCase() === "TRUE" ? "checked" : ""} onchange="updateMenu(${index}, 'Admin', this.checked)">
            <span class="checkmark"><i class="fa-solid fa-check"></i><i class="fa-solid fa-xmark"></i></span>
        </label>
      </td>
      <td class="text-center">
        <label class="customSet-checkbox">
            <input type="checkbox" ${rowIndex[4].toUpperCase() === "TRUE" ? "checked" : ""} onchange="updateMenu(${index}, 'SuperUser', this.checked)">
            <span class="checkmark"><i class="fa-solid fa-check"></i><i class="fa-solid fa-xmark"></i></span>
        </label>
      </td>
      <td class="text-center">
        <label class="customSet-checkbox">
            <input type="checkbox" ${rowIndex[5].toUpperCase() === "TRUE" ? "checked" : ""} onchange="updateMenu(${index}, 'User', this.checked)">
            <span class="checkmark"><i class="fa-solid fa-check"></i><i class="fa-solid fa-xmark"></i></span>
        </label>
      </td>
    `;
  });
}

const updateMenu = (index, role, isChecked) => {
  const menuItem = setDataMenu[index][1];
  const roleIndex = {
    'SuperAdmin': 2,
    'Admin': 3,  
    'SuperUser': 4,
    'User': 5
  }[role];
  setDataMenu[index][roleIndex] = isChecked ? "TRUE" : "FALSE";
  
  $.LoadingOverlay("show", { image: "", fontawesome: "fa fa-spinner fa-spin" });
  google.script.run.withSuccessHandler(async (res) => {
    $.LoadingOverlay("hide");
    await updateSpecificDataMenu();
    createToast("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", 1);
  }).updateMenuStatus(menuItem, role, isChecked);
}

const createToast = (message, status, delay = 1000 * 3) => {
const toast = document.createElement('div');
    toast.className = 'border-0';
      toast.classList.add('toast', 'show');
      toast.setAttribute('role', 'alert');
      toast.setAttribute('aria-live', 'assertive');
      toast.setAttribute('aria-atomic', 'true');
  if (status == 1) {
    toast.style.backgroundColor = 'var(--bs-set)';
    toast.style.color = 'var(--bs-white)';
  } else if (status == 0) {
    toast.style.backgroundColor = 'var(--bs-del)';
    toast.style.color = 'var(--bs-white)';
  } else if (status == 2) {
    toast.style.backgroundColor = 'var(--bs-upload)';
    toast.style.color = 'var(--bs-white)';
  } else if (status == 3) {
    toast.style.backgroundColor = 'var(--bs-edit)';
    toast.style.color = 'var(--bs-white)';
  } else if (status == 4) {
    toast.style.backgroundColor = 'var(--bs-exclamation)';
    toast.style.color = 'var(--bs-white)';
  }

const header = document.createElement('div');
      header.classList.add('toast-header', 'rounded-bottom-0');

const img = document.createElement('img');
      img.src = 'https://cdn.jsdelivr.net/gh/napusmobile/napusmobile@main/logo.png'; 
      img.classList.add('rounded', 'me-2');
      img.style.width = '20px';
      img.alt = '...';

const strong = document.createElement('strong');
      strong.classList.add('me-auto');
      strong.innerText = 'HRDrive|Epic Coding Channel';

const small = document.createElement('small');
      small.classList.add('text-body-secondary');
let secondsElapsed = 0;
      small.innerText = `‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ`;

const interval = setInterval(() => {
      secondsElapsed += 1;
      small.innerText = `${secondsElapsed} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
}, 1000);

const button = document.createElement('button');
      button.type = 'button';
      button.classList.add('btn-close');
      button.setAttribute('data-bs-dismiss', 'toast');
      button.setAttribute('aria-label', 'Close');
      button.onclick = () => {
      toast.remove();
      clearInterval(interval);
    };

      header.append(img, strong, small, button);

const body = document.createElement('div');
      body.classList.add('toast-body');
      body.style.fontSize = '14px';
      body.innerText = message;

      toast.append(header, body);

document.getElementById('toast-container').appendChild(toast);

setTimeout(() => {
  toast.classList.remove('show');
  toast.addEventListener('transitionend', () => {
  toast.remove();
  clearInterval(interval);
    });
  }, delay);
};
</script>
