<div class="row g-3 mt-2">
  <div class="col-12 col-lg-12 col-xl-12">
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-white">
        <div class="row g-3">
          <div class="col-12 col-md-4 mb-2 mb-md-0">üë¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
          <div class="col-12 col-md-8 d-flex flex-wrap justify-content-md-end">
            <input type="search" class="form-control float-sm-end me-2 mb-2 mb-md-0" style="width: auto;" id="searchEmployee" placeholder="üîç‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô..." oninput="filterEmployee()">
          </div>
        </div>
      </div>
      <div class="card-body rounded-4">
        <div class="table-responsive">
          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" class="text-center">#</th>
                <th scope="col" class="text-center">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
                <th scope="col" class="text-center">‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô</th>
                <th scope="col" class="text-center">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞</th>
                <th scope="col" class="text-center">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
                <th scope="col" class="text-center">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                <th scope="col" class="text-center">‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</th>
                <th scope="col" class="text-center">Action</th>
              </tr>
            </thead>
            <tbody id="tableEmployee">
              <tr>
                <td colspan='8' class='fw-bold text-danger text-center p-4'><i class='fa-solid fa-circle-info text-danger'></i> ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•! üòì</td>
              </tr>
            </tbody>       
          </table>
        </div>
        <div class="row mt-1">
          <div class="col-12 col-md-6 mb-2 mb-md-0 align-items-center" id="paginationEmployeeInfo"></div>
          <div class="col-12 col-md-6 d-flex justify-content-md-end align-items-center">
            <div id="paginationEmployee" class="pagination"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const renderEmployee = (res) => {
  const table = document.getElementById('tableEmployee');
  table.innerHTML = '';

  res.sort((a, b) => {
    const numA = parseInt(a[0].replace('USER-', ''));
    const numB = parseInt(b[0].replace('USER-', ''));
    return numA - numB;
  });

  if (res.length === 0) {
    const row = table.insertRow();
    row.innerHTML = `<td colspan='8' class='fw-bold text-danger text-center p-4'><i class='fa-solid fa-circle-info text-danger'></i> ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•! üòì</td>`;
    return;
  }

  res.forEach((rowIndex, index) => {
    let isActive = rowIndex[10] === "TRUE";
    if (rowIndex[10] === 'TRUE') {
      const checkrowIndex = [rowIndex[11], rowIndex[12], rowIndex[13], rowIndex[14], rowIndex[15], rowIndex[16], rowIndex[17], rowIndex[18], rowIndex[19], rowIndex[20], rowIndex[21], rowIndex[22], rowIndex[23], rowIndex[24], rowIndex[25], rowIndex[26], rowIndex[27], rowIndex[28], rowIndex[29], rowIndex[30], rowIndex[31], rowIndex[32]];
      const filledFields = checkrowIndex.filter(field => field && field.trim() !== '').length;
      const progressbar = Math.round((filledFields / checkrowIndex.length) * 100);
      const progressAngle = progressbar * 3.6;

      let progressColor;
      let buttonClass = 'upload-button';
      if (progressbar <= 25) {
        progressColor = 'var(--box4)';
        buttonClass = 'del-button';
      } else if (progressbar <= 50) {
        progressColor = 'var(--box3)';
        buttonClass = 'edit-button';
      } else if (progressbar <= 75) {
        progressColor = 'var(--box1)';
        buttonClass = 'set-button';
      } else {
        progressColor = 'var(--box2)';
        buttonClass = 'upload-button';
      }

      let bankImage = '';
      switch (rowIndex[24]) {
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-1.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-2.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÑ‡∏ó‡∏¢':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-3.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£‡πÑ‡∏ó‡∏¢':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-4.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-5.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-6.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ô‡∏≤‡∏Ñ‡∏¥‡∏ô':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-7.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ã‡∏µ‡πÑ‡∏≠‡πÄ‡∏≠‡πá‡∏°‡∏ö‡∏µ‡πÑ‡∏ó‡∏¢':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-8.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏¥‡∏™‡πÇ‡∏Å‡πâ':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-9.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ò‡∏ô‡∏ä‡∏≤‡∏ï':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-10.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏¢‡∏π‡πÇ‡∏≠‡∏ö‡∏µ':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-11.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏≠‡∏ã‡∏µ‡∏ö‡∏µ‡∏ã‡∏µ(‡πÑ‡∏ó‡∏¢)':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-12.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-13.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡∏™‡∏¥‡∏ô':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-14.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-15.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-16.png';
          break;
        case '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏¢‡πà‡∏≠‡∏¢':
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/bankThai/main/bank-17.png';
          break;
        default:
          bankImage = 'https://raw.githubusercontent.com/EPICCODING17/image/main/Logo-EicCoding.png';
          break;
      }

      var row = table.insertRow();
      row.innerHTML = `
        <td class="text-center"><span style="font-size: 14px;">${index + 1}</span></td>
        <td>
          <div style="display: flex; align-items: center;">
            <img class="rounded-circle" src="${rowIndex[7] ? rowIndex[7] : '‚ùå N/A'}" alt="ImageUsers" width="40" style="margin-right: 10px;">
            <div style="font-size: 14px;">
              <span>UID: ${rowIndex[0]}</span><br>
              <span>‡∏ä‡∏∑‡πà‡∏≠ ‡∏™‡∏Å‡∏∏‡∏•: ${rowIndex[3] ? rowIndex[3] : '‚ùå N/A'}</span><br>
              <span>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ${rowIndex[4] ? rowIndex[4] : '‚ùå N/A'}</span><br>
              <span>‡πÅ‡∏ú‡∏ô‡∏Å: ${rowIndex[5] ? rowIndex[5] : '‚ùå N/A'}</span>
            </div>
          </div>
        </td>
        <td>
          <span style="font-size: 14px;">‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô: ${rowIndex[11] ? rowIndex[11] : '‚ùå N/A'}</span><br>
          <span style="font-size: 14px;">‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢: ${rowIndex[21] ? rowIndex[21] : '‚ùå N/A'}</span><br>
          <span style="font-size: 14px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô: ${rowIndex[19] ? rowIndex[19] : '‚ùå N/A'}</span>
        </td>
        <td>
          <div style="display: flex; align-items: center;">
            <img class="rounded-circle" src="${bankImage}" alt="accountbank" width="40" style="margin-right: 10px;">
            <div style="font-size: 14px;">
              <span>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£: ${rowIndex[24] ? rowIndex[24] : '‚ùå N/A'}</span><br>
              <span>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: ${rowIndex[25] ? rowIndex[25] : '‚ùå N/A'}</span><br>
              <span>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${rowIndex[26] ? rowIndex[26] : '‚ùå N/A'} ‡∏™‡∏≤‡∏Ç‡∏≤: ${rowIndex[27] ? rowIndex[27] : '‚ùå N/A'}</span>
            </div>
          </div>
        </td>
        <td>
          <span style="font-size: 14px;">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${rowIndex[29] ? rowIndex[29] : '‚ùå N/A'}</span><br>
          <span style="font-size: 14px;">Email: ${rowIndex[30] ? rowIndex[30] : '‚ùå N/A'}</span><br>
          <span style="font-size: 14px;">‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: ${rowIndex[32] ? rowIndex[32] : '‚ùå N/A'}</span>
        </td>
        <td class="text-center" style="vertical-align: middle;">
          <div style="display: flex; align-items: center; justify-content: center;">
            <div class="custom-switch">
              <input type="checkbox" ${isActive ? 'checked' : ''} id="switch-${rowIndex[0]}" class="custom-switch-input" onchange="toggleUserStatus('${rowIndex[0]}', this.checked)">
              <label for="switch-${rowIndex[0]}" class="custom-switch-label"></label>
            </div>
          </div>
        </td>
        <td class="text-center" style="vertical-align: middle;">
          <div style="display: flex; align-items: center; justify-content: center;">
            <div class="circular-progress" style="--progress-color: ${progressColor}; --progress-angle: ${progressAngle}deg;">
              <span class="progress-value">${progressbar}%</span>
            </div>
          </div>
        </td>
        <td class="text-center" style="vertical-align: middle;">
          <div style="display: flex; align-items: center; justify-content: center;">
            <button type='button' class='btn btn-sm me-2 ${buttonClass}' onclick='editEmployee("${rowIndex[0]}");'><i class='fa-solid fa-check'></i> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
          </div>
        </td>
      `;
    }
  });
}

const filterEmployee = () => {
  const query = document.getElementById('searchEmployee').value.toLowerCase();
  filteredEmployee = dataUsers.filter(row => {
    return row.some(column => (column || '').toString().toLowerCase().includes(query));
  });

  renderEmployee(filteredEmployee);
}

document.addEventListener('DOMContentLoaded', (ev) => {
  let input = document.querySelector('input[id="employeeImg"]');
  input.addEventListener('change', (ev) => {
      if (input.files[0].type.indexOf("image/") > -1) {
        let img = document.getElementById('employeePreview');
        img.src = window.URL.createObjectURL(input.files[0]);
      }
  });
});

const reverseFormatDate = (dateStr) => {
  if (!dateStr) return '';
  const parts = dateStr.split('/');
  return `${parts[2]}-${parts[1]}-${parts[0]}`;
};

const editEmployee = (codeID) => {
  const rowIndex = dataUsers.find(row => row[0] === codeID);
  if (rowIndex) {
    $('#EmployeeModal').modal('show');
    $('#employeePreview').attr('src', rowIndex[7]); //Img
    $('#empDataKey').val(rowIndex[0]); //UID
    $('#empData1').val(rowIndex[3]); //‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏∏‡∏•
    $('#empData2').val(rowIndex[4]); //‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
    $('#empData3').val(rowIndex[5]); //‡πÅ‡∏ú‡∏ô‡∏Å
    $('#empData4').val(rowIndex[14]); //‡πÄ‡∏û‡∏®
    $('#empData5').val(rowIndex[15] ? reverseFormatDate(rowIndex[15]) : ''); //‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
    $('#empData6').val(rowIndex[16]); //‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥
    $('#empData7').val(rowIndex[17]); //‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û
    $('#empData8').val(rowIndex[18]); //‡∏û‡∏¥‡∏Å‡∏≤‡∏£/‡∏ó‡∏∏‡∏û‡∏û‡∏•‡∏†‡∏≤‡∏û

    $('#empData9').val(rowIndex[12]); //‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
    $('#empData10').val(rowIndex[13]); //‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°
    //‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°
    document.querySelectorAll('input[name="empData11"]').forEach(input => {
      input.checked = false;
      input.closest('.Employee-card').classList.remove('selected');
      if (input.value === rowIndex[28]) {
        input.checked = true;
        input.closest('.Employee-card').classList.add('selected');
      }
    });

    $('#empData12').val(rowIndex[29]); //‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
    $('#empData13').val(rowIndex[30]); //Email
    $('#empData14').val(rowIndex[31]); //Line
    $('#empData15').val(rowIndex[32]); //Phone

    $('#empData16').val(rowIndex[11]); //‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô
    $('#empData17').val(rowIndex[19] ? reverseFormatDate(rowIndex[19]) : ''); //‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
    $('#empData18').val(rowIndex[21]); //‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢
    $('#empData19').val(rowIndex[20] ? rowIndex[20].replace(/,/g, '') : ''); //‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á
    $('#empData20').val(rowIndex[22] ? rowIndex[22].replace(/,/g, '') : ''); //‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©

    $('#empData21').val(rowIndex[23]); //‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡πà‡∏≤‡∏¢
    $('#empData22').val(rowIndex[24]); //‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£
    $('#empData23').val(rowIndex[25]); //‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
    //‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
    document.querySelectorAll('input[name="empData24"]').forEach(input => {
      input.checked = false;
      input.closest('.Employee-card').classList.remove('selected');
      if (input.value === rowIndex[26]) {
        input.checked = true;
        input.closest('.Employee-card').classList.add('selected');
      }
    });
    $('#empData25').val(rowIndex[27]); //‡∏™‡∏≤‡∏Ç‡∏≤
  }
}

const submitDataEmployee = () => {
  event.preventDefault();
  $.LoadingOverlay("show", { image: "", fontawesome: "fa fa-spinner fa-spin" });
  const obj = {
    empCode: document.getElementById("empDataKey").value,
    empData1: document.getElementById("empData1").value,
    empData2: document.getElementById("empData2").value,
    empData3: document.getElementById("empData3").value,
    empData4: document.getElementById("empData4").value,
    empData5: document.getElementById("empData5").value,
    empData6: document.getElementById("empData6").value,
    empData7: document.getElementById("empData7").value,
    empData8: document.getElementById("empData8").value,
    empData9: document.getElementById("empData9").value,
    empData10: document.getElementById("empData10").value,
    empData11: document.querySelector('input[name="empData11"]:checked').value,
    empData12: document.getElementById("empData12").value,
    empData13: document.getElementById("empData13").value,
    empData14: document.getElementById("empData14").value,
    empData15: document.getElementById("empData15").value,
    empData16: document.getElementById("empData16").value,
    empData17: document.getElementById("empData17").value,
    empData18: document.getElementById("empData18").value,
    empData19: document.getElementById("empData19").value,
    empData20: document.getElementById("empData20").value,
    empData21: document.getElementById("empData21").value,
    empData22: document.getElementById("empData22").value,
    empData23: document.getElementById("empData23").value,
    empData24: document.querySelector('input[name="empData24"]:checked').value,
    empData25: document.getElementById("empData25").value
  };

  if ($("#employeeImg").val() === "") {
    obj.profile = $("#employeePreview").attr("src");
  } else {
    const imgElement = document.getElementById("employeePreview");
    const canvas = document.createElement("canvas");
    const context = canvas.getContext("2d");
    canvas.width = imgElement.naturalWidth;
    canvas.height = imgElement.naturalHeight;
    context.drawImage(imgElement, 0, 0, imgElement.naturalWidth, imgElement.naturalHeight);
    obj.imageDataUrl = canvas.toDataURL("image/png");
    obj.filetype = "image/png";
    obj.filename = obj.empData1;
  }

  if (!obj.empCode || !obj.empData1 || !obj.empData2 || !obj.empData3 || !obj.empData4 || !obj.empData5 || !obj.empData6 || !obj.empData7 || !obj.empData8 || !obj.empData9 || !obj.empData10) {
    createToast("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô", 3);
    $.LoadingOverlay("hide");
    return;
  }

  google.script.run.withSuccessHandler(async (res) => {
    $.LoadingOverlay("hide");
    $('#EmployeeModal').modal('hide');
    await updateSpecificDataUsers();
    createToast("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", 1);
  }).saveDataEmployee(obj);
};

const selectEmpCard = (selectedId, groupName) => {
  document.querySelectorAll(`.Employee-card input[name='${groupName}']`).forEach(input => {
    input.closest('.Employee-card').classList.remove('selected');
    input.checked = false;
  });
  const selectedCard = document.getElementById(selectedId);
  selectedCard.classList.add('selected');
  selectedCard.querySelector('input').checked = true;
};

const clearDataEmployee = () => {
  $('#EmployeeModal').modal('hide');
  document.getElementById("employeeImg").value = "";
  document.getElementById("employeePreview").src = "https://img2.pic.in.th/pic/vsvds.png";

  document.getElementById("empDataKey").value = "";
  document.getElementById("empData1").value = "";
  document.getElementById("empData2").value = "";
  document.getElementById("empData3").value = "";
  document.getElementById("empData4").value = "";
  document.getElementById("empData5").value = "";
  document.getElementById("empData6").value = "";
  document.getElementById("empData7").value = "";
  document.getElementById("empData8").value = "";
  document.getElementById("empData9").value = "";
  document.getElementById("empData10").value = "";
  document.getElementById("empData12").value = "";
  document.getElementById("empData13").value = "";
  document.getElementById("empData14").value = "";
  document.getElementById("empData15").value = "";
  document.getElementById("empData16").value = "";
  document.getElementById("empData17").value = "";
  document.getElementById("empData18").value = "";
  document.getElementById("empData19").value = "";
  document.getElementById("empData20").value = "";
  document.getElementById("empData21").value = "";
  document.getElementById("empData22").value = "";
  document.getElementById("empData23").value = "";
  document.getElementById("empData25").value = "";

  document.querySelectorAll('.Employee-card').forEach(card => {
    card.classList.remove('selected');
  });

  document.getElementById("radioCheckDataA").checked = true;
  document.getElementById("radioCheckDataC").checked = true;

  document.getElementById("cardCheckDataA").classList.add('selected');
  document.getElementById("cardCheckDataC").classList.add('selected');
};
</script>
